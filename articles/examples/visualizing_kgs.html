<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Visualizing Knowledge Graphs • monarchr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><link href="../../extra.css" rel="stylesheet">
<meta property="og:title" content="Visualizing Knowledge Graphs">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">monarchr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../articles/monarchr.html">Get started</a>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="divider">
    </li>
<li class="dropdown-header">Examples</li>
    <li>
      <a href="../../articles/examples/visualizing_kgs.html">Visualizing Knowledge Graphs</a>
    </li>
    <li>
      <a href="../../articles/examples/exploring_kgs.html">Exploring Knowledge Graphs</a>
    </li>
    <li>
      <a href="../../articles/examples/transitive_rollups.html">Rollups and Transitivity</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/monarch-initiative/monarchr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Visualizing Knowledge Graphs</h1>
                        <h4 data-toc-skip class="author">Shawn T
O’Neil</h4>
            
            <h4 data-toc-skip class="date">Vignette updated:
<i>May-16-2025</i>
</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/monarch-initiative/monarchr/blob/rollups/vignettes/examples/visualizing_kgs.Rmd" class="external-link"><code>vignettes/examples/visualizing_kgs.Rmd</code></a></small>
      <div class="hidden name"><code>visualizing_kgs.Rmd</code></div>

    </div>

    
    
<p><code>monarchr</code> supports a large number of plotting frameworks
compatible with <code>tidygraph</code> and <code>igraph</code>,
including <a href="https://ggraph.data-imaginist.com/" class="external-link"><code>ggraph</code></a>, <a href="https://datastorm-open.github.io/visNetwork/" class="external-link"><code>visNetwork</code></a>,
and <a href="https://bwlewis.github.io/rthreejs/" class="external-link"><code>threejs</code></a>.
Included are a basic <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> for knowledge graphs via
<code>ggraph</code>, and a <code><a href="../../reference/cytoscape.html">cytoscape()</a></code> function to export a
graph to a running <a href="https://cytoscape.org/" class="external-link">Cytoscape</a>
instance via <a href="https://www.bioconductor.org/packages/release/bioc/html/RCy3.html" class="external-link"><code>RCy3</code></a>.</p>
<p>As usual, we begin by loading the <code>monarchr</code> package,
along with <code>tidygraph</code> and <code>dplyr</code> which tend to
be useful.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/monarch-initiative/monarchr" class="external-link">monarchr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidygraph.data-imaginist.com" class="external-link">tidygraph</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="basic-plot">Basic <code>plot()</code><a class="anchor" aria-label="anchor" href="#basic-plot"></a>
</h2>
<p>The basic <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function is a wrapper around
<code>ggraph</code>. By default, node color tracks
<code>pcategory</code> and edge color <code>predicate</code>, though
these can be changed with the <code>node_color</code> and
<code>edge_color</code> properties.</p>
<p>While <code>node_shape</code> and <code>edge_linetype</code> can also
be changed, they default to <code>namespace</code> (commonly indicating
the node’s data source) and <code>primary_knowledge_source</code>
(commonly indicating the edge’s data source). Here we see that these
nodes are part of <a href="https://mondo.monarchinitiative.org/" class="external-link"><code>MONDO</code></a> and
<a href="https://www.genenames.org/" class="external-link"><code>HGNC</code></a>, and the
relationships between them are sourced from MONDO as well as <a href="https://omim.org/" class="external-link">OMIM</a> and <a href="https://www.orpha.net/" class="external-link">Orphanet</a>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">filename</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"eds_marfan_kg.tar.gz"</span>, package <span class="op">=</span> <span class="st">"monarchr"</span><span class="op">)</span></span>
<span><span class="va">engine</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/file_engine.html">file_engine</a></span><span class="op">(</span><span class="va">filename</span><span class="op">)</span></span>
<span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="va">engine</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../../reference/fetch_nodes.html">fetch_nodes</a></span><span class="op">(</span>query_ids <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MONDO:0017310"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../../reference/expand.html">expand</a></span><span class="op">(</span>predicates <span class="op">=</span> <span class="st">"biolink:subclass_of"</span>, direction <span class="op">=</span> <span class="st">"in"</span>, transitive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../../reference/expand.html">expand</a></span><span class="op">(</span>categories <span class="op">=</span> <span class="st">"biolink:Gene"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span></code></pre></div>
<p><img src="visualizing_kgs_files/figure-html/unnamed-chunk-3-1.png" width="960">
In this example we first fetch Neonatal Marfan Syndrome, Brittle Cornea
Syndrome, and their direct phenotypes. We then take the join of these
two graphs, compute the degree of each node and filter to only those
nodes with <code>degree &gt; 2</code>, indicating only phenotypes
connected with both. For plotting, we use <code>edge_color</code> set to
<code>frequency_qualifier</code>, but we recode those by their
interpretation. The <code>edge_color</code> and <code>node_color</code>
parameters simply pass their unquoted arguments to
<code>geom_node_point</code> and <code>geom_edge_fan</code>
<code>ggraph</code> layers.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mar_phenos</span> <span class="op">&lt;-</span> <span class="va">engine</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../../reference/fetch_nodes.html">fetch_nodes</a></span><span class="op">(</span>query_ids <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MONDO:0017309"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../../reference/expand.html">expand</a></span><span class="op">(</span>categories <span class="op">=</span> <span class="st">"biolink:PhenotypicFeature"</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">bcs_phenos</span> <span class="op">&lt;-</span> <span class="va">engine</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../../reference/fetch_nodes.html">fetch_nodes</a></span><span class="op">(</span>query_ids <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MONDO:0009242"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../../reference/expand.html">expand</a></span><span class="op">(</span>categories <span class="op">=</span> <span class="st">"biolink:PhenotypicFeature"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">both</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/kg_join.html">kg_join</a></span><span class="op">(</span><span class="va">mar_phenos</span>, <span class="va">bcs_phenos</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">shared</span> <span class="op">&lt;-</span> <span class="va">both</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidygraph.data-imaginist.com/reference/activate.html" class="external-link">activate</a></span><span class="op">(</span><span class="va">nodes</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>degree <span class="op">=</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/degree.html" class="external-link">degree</a></span><span class="op">(</span><span class="va">both</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">degree</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidygraph.data-imaginist.com/reference/activate.html" class="external-link">activate</a></span><span class="op">(</span><span class="va">edges</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>frequency_qualifier <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">frequency_qualifier</span>, </span>
<span>                                      levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"HP:0040281"</span>, <span class="st">"HP:0040282"</span>, <span class="st">"HP:0040283"</span><span class="op">)</span>,</span>
<span>                                      labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"very_frequent"</span>, <span class="st">"frequent"</span>, <span class="st">"occasional"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">shared</span>, edge_color <span class="op">=</span> <span class="va">frequency_qualifier</span><span class="op">)</span></span></code></pre></div>
<p><img src="visualizing_kgs_files/figure-html/unnamed-chunk-4-1.png" width="960"></p>
<p>Tidygraph <a href="https://tidygraph.data-imaginist.com/" class="external-link">utilities</a> support easy
modification of node and edge tables, breadth- and depth-first maps, and
other graph-centric methods, all of which may be visualized in creative
ways.</p>
</div>
<div class="section level2">
<h2 id="exporting-with-cytoscape">Exporting with <code>cytoscape()</code><a class="anchor" aria-label="anchor" href="#exporting-with-cytoscape"></a>
</h2>
<p>Local knowledge graphs can also be visualized with <a href="https://cytoscape.org/" class="external-link">Cytoscape</a>, which must be running on
the same machine as <code>monarchr</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/cytoscape.html">cytoscape</a></span><span class="op">(</span><span class="va">mar_phenos</span><span class="op">)</span></span></code></pre></div>
<p>Node color is mapped to <code>pcategory</code> and edge color to
<code>predicate</code>; hoverover node text is <code>description</code>
if available, edge hoverover <code>predicate</code>. All of these and
many more properties can be customized in Cytoscape.</p>
<center>
<img src="visualizing_kgs_assets/cytoscape.png" style="width:90.0%">
</center>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Shawn O’Neil, Brian Schilder.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

      </footer>
</div>






  </body>
</html>
